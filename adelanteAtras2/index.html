<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Uso de funciones(II) - Rupertobot</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Rupertobot</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Introducción</a>
                            </li>
                            <li class="navitem">
                                <a href="../about/" class="nav-link">¿Quién soy?</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Archivos <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../cad/archivosCAD/" class="dropdown-item">Archivos en FreeCAD (modificables)</a>
</li>
                                    
<li>
    <a href="../STL/archivosSTL/" class="dropdown-item">Archivos STL (para imprimir en 3D)</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../montaje/" class="nav-link">Instrucciones de montaje</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Conexionado <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../alimentacion/" class="dropdown-item">Alimentación</a>
</li>
                                    
<li>
    <a href="../conexionadoStepper/" class="dropdown-item">Motores paso a paso (stepper)</a>
</li>
                                    
<li>
    <a href="../conexionadoSensores/" class="dropdown-item">Sensores US e IR</a>
</li>
                                    
<li>
    <a href="../conexionadoZumbador/" class="dropdown-item">Zumbador</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ejemplos de programación <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../movimiento/" class="dropdown-item">Mover una rueda</a>
</li>
                                    
<li>
    <a href="../adelante/" class="dropdown-item">Hacia adelante</a>
</li>
                                    
<li>
    <a href="../atras/" class="dropdown-item">Hacia atras</a>
</li>
                                    
<li>
    <a href="../izquierdaDerecha/" class="dropdown-item">Cómo girar</a>
</li>
                                    
<li>
    <a href="../adelanteAtras/" class="dropdown-item">Uso de funciones(I)</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Uso de funciones(II)</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../siguelineas/" class="nav-link">Rupertobot como siguelíneas</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../adelanteAtras/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../siguelineas/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#funciones-ii" class="nav-link">Funciones (II)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#introduccion" class="nav-link">Introducción</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#justificacion-matematica" class="nav-link">Justificación matemática</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#uso-de-funciones-con-argumentos" class="nav-link">Uso de funciones con argumentos</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#modificamos-el-resto-de-funciones" class="nav-link">Modificamos el resto de funciones</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#programa-de-prueba" class="nav-link">Programa de prueba</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#programa-tu-arduino" class="nav-link">Programa tu Arduino</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#descarga-los-programas" class="nav-link">Descarga los programas</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="funciones-ii">Funciones (II)</h1>
<h2 id="introduccion">Introducción</h2>
<p>Si has leído la sección anterior (es lo que uno supondría más lógico, pero cuando hablamos de estudiantes de Educación Secundaria, nunca desecho ninguna hipótesis), habrás aprendido a crear funciones de modo que puedes repetir el código varias veces, tantas como te limites a llamar a cada función por su nombre. No obstante, también hemos explicado que con ese enfoque, cada vez que llamemos a la función <strong><em>adelante</em></strong>, por ejemplo, Rupertobot siempre avanzará exactamente la misma distancia: 3,14 multiplicado por 80, es decir, 251,33 mm (más o menos). Esto es así porque tal y como hemos construido la función, ésta siempre se va a ejecutar exactamente del mismo modo, tal y como la hemos escrito. Lo ideal, ahora, sería que pudiéramos introducir un valor que permitiera a <strong><em>adelante</em></strong> repetir el bucle de su interior un número de veces variable, según la distancia que queramos avanzar. Para ello, pasamos a explicar cómo usar parámetros con nuestras funciones.  </p>
<h2 id="justificacion-matematica">Justificación matemática</h2>
<p>Lo que queremos hacer es usar funciones paramétricas en las que indiquemos en los casos de <strong><em>adelante</em></strong> y <strong><em>atras</em></strong>, cuántos centímetros queremos movernos, y en el de <strong><em>izquierda</em></strong> y <strong><em>derecha</em></strong>, cuántos grados queremos girar. Tiremos, entonces, de nuestros conocimientos de geometría: </p>
<p>La función <strong><em>adelante</em></strong> original genera un total de 2048 pasos hacia adelante, lo que corresponde a una revolución completa en ambas ruedas del Rupertobot. Como el diámetro de dichas ruedas es alrededor de unos 80 mm (ya te he dicho que este dato varía según el grosor de las juntas tóricas), conociendo la fórmula de la longitud de una circunferencia, sabemos que eso equivaldría a un avance de 251,33 mm, o mejor, 25,13 cm. Quédate con el dato: 2048 pasos-&gt;25,13 cm. </p>
<p>Lo que resta es una regla de tres (que me perdonen los profes de Matemáticas, sé que esto no está bien visto) sencilla: Si 25,13 cm exigen 2048 pasos, entonces avanzar 1 cm exigirá 2048/25,13=81,4873 pasos. Ten en cuenta que el algoritmo inicial de <strong><em>adelante</em></strong> aplica 4 pasos a cada repetición, así que 81,4873/4=20,3718. Ése es el número de veces que tenemos que repetir este proceso por cada cm que queremos avanzar.  </p>
<p><em>Nota para tiquismiquis: si estás comprobando mi explicación calculadora en mano, puede que te baile algún número a la altura de milésimas o diezmilésimas, no lo estoy comprobando. Los números que manejo los saco de mi propia calculadora sin usar redondeos. Si quieres cambiar algo, eres muy libre, es tu robot</em>. </p>
<p>Por otro lado, si has probado la función <strong><em>izquierda</em></strong> o <strong><em>derecha</em></strong>, verás que como hacen avanzar una revolución completa a cada rueda (2048 pasos), haremos que el robot gire sobre su eje 180º. ¿Cuántos pasos necesito avanzar por grado sexagesimal, entonces?. La aritmética es sencilla, de nuevo. La función original, que da 2048 pasos, implica un giro de 180º. Así que un sólo grado corresponderá a 2048/180=11,3778 pasos. Teniendo en cuenta que las funciones originales implican 4 pasos por repetición, el algoritmo original debería repetirse 2.8444 veces por grado sexagesimal. Quédate, pues, con esos dos números: <strong>20,3718</strong> y <strong>2,8444</strong>  </p>
<p>Lo que vamos a hacer a continuación es modificar nuestras funciones para que acepten parámetros. Si has entendido el concepto de que una función es un grupo de órdenes asociadas a un nombre (por ejemplo, <strong><em>adelante</em></strong>) que se ejecutan en orden cuando se llama a dicho nombre, entenderás ahora que las funciones pueden trabajar con parámetros. Un parámetro, o argumento, es un dato (de cualquier tipo, número entero, decimal, lógico... incluso se aceptan caracteres) que puedo dar yo a la función para que lo utilice de algún modo (<em>parámetros/argumentos de entrada</em>) o que puedo pedir a la función que me devuelva después de ejecutarse, como consecuencia de algún cálculo (<em>parámetros/argumentos de salida</em>). </p>
<p>Lo sé, lo sé. Parece complicado. El movimiento se demuestra andando, así que vamos con ello.</p>
<h2 id="uso-de-funciones-con-argumentos">Uso de funciones con argumentos</h2>
<p>En este caso, vamos a trabajar con <em>argumentos de entrada</em>. Esto significa que cuando yo ejecute una función, primero tengo que proporcionarle un dato (en la función <strong><em>adelante</em></strong>, cuántos cm quiero que se mueva hacia adelante) y dicha función lo utilizará para que Rupertobot haga lo que yo quiero. </p>
<p>¡Bueno!. Pues en MasayloBlockly, retoma las funciones del ejemplo anterior. Vamos a modificar la función <strong><em>adelante</em></strong> para que acepte argumentos. En la esquina superior izquierda del bloque que representa dicha función, verás un icono azul en forma de engranaje. Si pinchas ahí, te ofrecerá la posibilidad de usar variables (parámetros)</p>
<p><img alt="Cómo introducir argumentos en una función" src="../img/introduzcoVariables1.png" /><br />
Yo quiero introducir un argumento correspondiente a cuántos cm quiero que se mueva Rupertobot hacia adelante. Este número va a aceptar decimales, así que cambio la "x" que viene por defecto por el nombre "cm", y en el tipo, voy a especificar "decimal de punto flotante". Una vez lo haga, arrastra el bloque correspondiente a ese variable dentro del bloque "argumentos de entrada": 
<img alt="Configurando el tipo de argumento dentro de una función" src="../img/introduzcoVariables2.png" /><br />
Vuelve a pinchar en el engranaje, para que desaparezca el recuadro de configuración y te deje más espacio en la pantalla. Si ahora buscas la función <strong><em>adelante</em></strong>, verás que el bloque ha cambiado ligeramente: ahora la pieza de puzzle acepta un bloque lateral, que será un número del bloque <strong>Matemáticas</strong> correspondiente al número de cm que quiero avanzar. </p>
<p><img alt="Ahora mi función acepta un argumento de entrada" src="../img/introduzcoVariables3.png" />  </p>
<p>¡Pero ojo!. Aún no hemos terminado. Ya he preparado mi función para que acepte argumentos, pero ¿cómo la modifico para que realmente mi Rupertobot se mueva la distancia especificada?. Sencillo (para mí, claro, que soy más viejo que un bosque y llevo meses trabajando en el Ruperti; pero tú también lo vas a entender enseguida). En el bloque <em>Repetir</em>, que originalmente incluía el número <em>512 veces</em>, vamos a introducir un bloque de <em>Matemáticas</em> correspondiente a operaciones (inicialmente lleva el signo <em>+</em>, pero sustitúyelo por una multiplicación). En dicho bloque multiplicaremos, por un lado, la variable que hemos creado, <em>cm</em> (está disponible en el bloque <em>Variables</em>; si no lo encuentras, vuelve a la configuración de MasayloBlockly y actívalo desde el nivel <em>Experto</em>), y por otro lado, el número 20,3718.
<img alt="Preparando el bloque que utilizará el argumento *cm*" src="../img/introduzcoVariables4.png" /><br />
Sólo te queda poner el bloque que has creado en lugar del número original, <em>512</em>. Ahora vamos a usar la función modificada para hacer que Rupertobot avance 15 cm (la función acepta también números enteros): 
<img alt="Programo a Rupertobot para que avance 15 cm" src="../img/introduzcoVariables5.png" /><br />
Vuelca el programa en tu robot y, regla en mano, comprueba la distancia que realmente se mueve. Si no te acaba de convencer el resultado, recalcula tú y sustituye el número <em>20,3718</em>. Pero yo creo que encontrarás más que aceptable el movimiento final.</p>
<h2 id="modificamos-el-resto-de-funciones">Modificamos el resto de funciones</h2>
<p>Lo que queda por hacer es sencillo. Repite el proceso con <strong><em>atras</em></strong>, <strong><em>izquierda</em></strong> y <strong><em>derecha</em></strong>. <strong><em>atras</em></strong> puede (y debería) utilizar la misma variable, <em>cm</em>, así como el número <strong>20,7318</strong>. En cuanto a <strong><em>izquierda</em></strong> y <strong><em>derecha</em></strong>, deberías especificar el argumento <em>grados</em>, también de tipo decimal de coma flotante, y recordando que el número ahora sería <strong>2,8444</strong>. 
<img alt="En las funciones de giro utilizaremos la variable *grados*" src="../img/introduzcoVariables6.png" />  </p>
<h2 id="programa-de-prueba">Programa de prueba</h2>
<p>Haz algún programa que te permita comprobar si las funciones trabajan como deberían. Yo te propongo este, por ejemplo. Al acabar, el robot debería acabar exactamente en la misma posición que ha empezado: </p>
<p><img alt="Probando las funciones con argumentos" src="../img/introduzcoVariables7.png" />  </p>
<h2 id="programa-tu-arduino">Programa tu Arduino</h2>
<p>Si quieres ver cómo quedaría la nueva función <strong><em>adelante</em></strong> en la IDE de Arduino, te dejo el código en C++ con esta función y cómo se ejecutaría para avanzar 15 cm, tal y como especificábamos en uno de los ejemplos anteriores (si quieres el resto de funciones, más abajo puedes descargarlas):</p>
<pre><code class="language-json">void adelante(float cm) {
  for (int count=0 ; count&lt;cm * 20.3718 ; count++) {
    digitalWrite(2, HIGH);
    digitalWrite(3, LOW);
    digitalWrite(4, LOW);
    digitalWrite(5, LOW);
    digitalWrite(6, LOW);
    digitalWrite(7, LOW);
    digitalWrite(8, LOW);
    digitalWrite(9, HIGH);
    delay(2);
    digitalWrite(2, LOW);
    digitalWrite(3, HIGH);
    digitalWrite(4, LOW);
    digitalWrite(5, LOW);
    digitalWrite(6, LOW);
    digitalWrite(7, LOW);
    digitalWrite(8, HIGH);
    digitalWrite(9, LOW);
    delay(2);
    digitalWrite(2, LOW);
    digitalWrite(3, LOW);
    digitalWrite(4, HIGH);
    digitalWrite(5, LOW);
    digitalWrite(6, LOW);
    digitalWrite(7, HIGH);
    digitalWrite(8, LOW);
    digitalWrite(9, LOW);
    delay(2);
    digitalWrite(2, LOW);
    digitalWrite(3, LOW);
    digitalWrite(4, LOW);
    digitalWrite(5, HIGH);
    digitalWrite(6, HIGH);
    digitalWrite(7, LOW);
    digitalWrite(8, LOW);
    digitalWrite(9, LOW);
    delay(2);
  }
}


void setup() {
  pinMode(2, OUTPUT);
  pinMode(3, OUTPUT);
  pinMode(4, OUTPUT);
  pinMode(5, OUTPUT);
  pinMode(6, OUTPUT);
  pinMode(7, OUTPUT);
  pinMode(8, OUTPUT);
  pinMode(9, OUTPUT);
}

void loop() {
  adelante(15);
  while(true);
}
</code></pre>
<h2 id="descarga-los-programas">Descarga los programas</h2>
<p><a href="../programas/funcionesconParametros.bloc">Ejemplo de las funciones con argumentos adelante, atrás, izquierda y derecha para MasayloBlockly</a><br />
<a href="../programas/funcionesconParametros.ino">Ejemplo de las funciones con argumentos adelante, atrás, izquierda y derecha para la IDE de Arduino</a> </p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
